{"version":3,"file":"static/js/698.30c29254.js","mappings":"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","sources":["webpack://ibookingsystem-vue/./src/views/user/SignIn.vue","webpack://ibookingsystem-vue/src/views/user/SignIn.vue","webpack://ibookingsystem-vue/./src/views/user/SignIn.vue?e5ea","webpack://ibookingsystem-vue/./src/views/user/SignIn.vue?213f","webpack://ibookingsystem-vue/./src/network/index.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('el-descriptions',{staticClass:\"margin-top\",attrs:{\"title\":\"个人信息\",\"column\":2,\"size\":_vm.size,\"border\":\"\"}},[_c('template',{slot:\"extra\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"}},[_vm._v(\"操作\")])],1),_c('el-descriptions-item',[_c('template',{slot:\"label\"},[_c('i',{staticClass:\"el-icon-s-promotion\"}),_vm._v(\" 邮箱 \")]),_vm._v(\" \"+_vm._s(_vm.email)+\" \")],2),_c('el-descriptions-item',[_c('template',{slot:\"label\"},[_c('i',{staticClass:\"el-icon-user-solid\"}),_vm._v(\" 用户名 \")]),_vm._v(\" \"+_vm._s(_vm.name)+\" \")],2),_c('el-descriptions-item',[_c('template',{slot:\"label\"},[_c('i',{staticClass:\"el-icon-star-on\"}),_vm._v(\" 密码 \")]),_vm._v(\" ******* \")],2),_c('el-descriptions-item',[_c('template',{slot:\"label\"},[_c('i',{staticClass:\"el-icon-s-home\"}),_vm._v(\" 是否违规 \")]),_vm._v(\" \"+_vm._s(_vm.violate == '1' ? \"是\" : '否')+\" \")],2)],2),_c('el-table',{attrs:{\"data\":_vm.appointments,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"c_name\",\"label\":\"自习室名称\"}}),_c('el-table-column',{attrs:{\"prop\":\"s_name\",\"label\":\"座位名称\"}}),_c('el-table-column',{attrs:{\"prop\":\"start_time\",\"label\":\"开始时间\"}}),_c('el-table-column',{attrs:{\"prop\":\"end_time\",\"label\":\"结束时间\"}}),_c('el-table-column',{attrs:{\"label\":\"倒计时\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(_vm._s(_vm.getRemainingTime(scope.row)))])]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"disabled\":scope.row.is_check_in ? true : false},on:{\"click\":function($event){return _vm.signIn(scope.row)}}},[_vm._v(\"签到\")])]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.cancelSignIn(scope.row)}}},[_vm._v(\"取消\")])]}}])})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div>\r\n      <el-descriptions class=\"margin-top\" title=\"个人信息\" :column=\"2\" :size=\"size\" border>\r\n        <template slot=\"extra\">\r\n          <el-button type=\"primary\" size=\"small\">操作</el-button>\r\n        </template>\r\n        <el-descriptions-item>\r\n          <template slot=\"label\">\r\n            <i class=\"el-icon-s-promotion\"></i>\r\n            邮箱\r\n          </template>\r\n          {{email}}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item>\r\n          <template slot=\"label\">\r\n            <i class=\"el-icon-user-solid\"></i>\r\n            用户名\r\n          </template>\r\n          {{name}}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item>\r\n          <template slot=\"label\">\r\n            <i class=\"el-icon-star-on\"></i>\r\n            密码\r\n          </template>\r\n          *******\r\n        </el-descriptions-item>\r\n        <el-descriptions-item>\r\n          <template slot=\"label\">\r\n            <i class=\"el-icon-s-home\"></i>\r\n            是否违规\r\n          </template>\r\n          {{violate == '1' ? \"是\" : '否'}}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n    <el-table :data=\"appointments\" border>\r\n      <el-table-column prop=\"c_name\" label=\"自习室名称\"></el-table-column>\r\n      <el-table-column prop=\"s_name\" label=\"座位名称\"></el-table-column>\r\n      <el-table-column prop=\"start_time\" label=\"开始时间\"></el-table-column>\r\n      <el-table-column prop=\"end_time\" label=\"结束时间\"></el-table-column>\r\n      <el-table-column label=\"倒计时\">\r\n        <template slot-scope=\"scope\">\r\n          <span>{{ getRemainingTime(scope.row) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column label=\"操作\">\r\n        <template slot-scope=\"scope\">\r\n          <!-- <el-button type=\"primary\" size=\"small\" @click=\"stopCountdown(scope.row)\">签到</el-button> -->\r\n          <el-button type=\"primary\" size=\"small\" :disabled=\"scope.row.is_check_in ? true : false\" @click=\"signIn(scope.row)\">签到</el-button>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column label=\"操作\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"primary\" size=\"small\" @click=\"cancelSignIn(scope.row)\">取消</el-button>\r\n        </template>\r\n      </el-table-column>\r\n\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getUserInfoById, cancelByPid, singInByPid } from '../../network/index';\r\nexport default {\r\n  data() {\r\n    return {\r\n      size: 'medium',\r\n      uid: 0,\r\n      name: '',\r\n      email: '',\r\n      password: '',\r\n      violate: '',\r\n      appointments: [\r\n        // {\r\n        //   roomName: '自习室 A',\r\n        //   seatId: 1,\r\n        //   startTime: '2023-05-22 17:00',\r\n        //   endTime: '2023-05-22 20:00',\r\n        //   countdownIntervalId: null,\r\n        //   remainingTime: null,\r\n        // },\r\n      ],\r\n      canSignIn: false\r\n    };\r\n  },\r\n  mounted() {\r\n    getUserInfoById(this.$route.params.id).then(res => {\r\n        console.log(this.$route.params.id)\r\n        console.log(res)\r\n        this.uid = res.data.results.id\r\n        this.name = res.data.results.name\r\n        this.email = res.data.results.email\r\n        this.appointments = res.data.results.pre_list\r\n        this.violate = res.data.results.violate\r\n        //console.log(this.appointments)\r\n        this.startCountdown();\r\n    })\r\n  },\r\n  methods: {\r\n    calculateDistance(lat1, lon1, lat2, lon2) {\r\n      const earthRadius = 6371000; // 地球半径（单位：米）\r\n\r\n      const degToRad = (deg) => deg * (Math.PI / 180);\r\n      const deltaLat = degToRad(lat2 - lat1);\r\n      const deltaLon = degToRad(lon2 - lon1);\r\n\r\n      const a =\r\n        Math.sin(deltaLat / 2) * Math.sin(deltaLat / 2) +\r\n        Math.cos(degToRad(lat1)) * Math.cos(degToRad(lat2)) *\r\n        Math.sin(deltaLon / 2) * Math.sin(deltaLon / 2);\r\n      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n      const distance = earthRadius * c;\r\n\r\n      return distance;\r\n    },\r\n    cancelSignIn(pre_item) {\r\n        cancelByPid(pre_item.pid).then(res => {\r\n            if (res.data.results.isCancel) {\r\n                alert('取消成功！')\r\n                //删除当前行\r\n                // const index = this.appointments.indexOf(pre_item)\r\n                // if (index != -1) {\r\n                //     this.appointments.splice(index, 1);\r\n                // }\r\n                getUserInfoById(this.$route.params.id).then(res => {\r\n                    console.log(this.$route.params.id)\r\n                    console.log(res)\r\n                    this.uid = res.data.results.id\r\n                    this.name = res.data.results.name\r\n                    this.email = res.data.results.email\r\n                    this.appointments = res.data.results.pre_list\r\n                    //console.log(this.appointments)\r\n                    //this.startCountdown();\r\n                })\r\n            } \r\n            else {\r\n                alert('取消失败！')\r\n            }\r\n        })\r\n    },\r\n    signIn(pre_item) {\r\n      // if (navigator.geolocation) {\r\n      //   navigator.geolocation.getCurrentPosition(\r\n      //     position => this.successCallback(position, pre_item),\r\n      //     this.errorCallback\r\n      //   );\r\n      // } else {\r\n      //   alert('浏览器不支持地理位置定位');\r\n      // }\r\n      if (true) {\r\n        //发送签到请求\r\n        console.log(pre_item);\r\n        singInByPid(pre_item.pid).then(res => {\r\n            if (res.data.results.isSignUp) {\r\n                alert('签到成功')\r\n                getUserInfoById(this.$route.params.id).then(res => {\r\n                    console.log(this.$route.params.id)\r\n                    console.log(res)\r\n                    this.uid = res.data.results.id\r\n                    this.name = res.data.results.name\r\n                    this.email = res.data.results.email\r\n                    this.appointments = res.data.results.pre_list\r\n                    //console.log(this.appointments)\r\n                    //this.startCountdown();\r\n                })                \r\n            } else {\r\n                alert('签到失败')\r\n            }\r\n        })\r\n      } else {\r\n        alert('不在签到范围内！');\r\n      }\r\n\r\n    },\r\n    successCallback(position, pre_item) {\r\n      // 获取用户当前位置的经纬度\r\n      const target_latitude = 31.3347;\r\n      const target_longitude = 121.4165;\r\n\r\n      const latitude = position.coords.latitude;\r\n      const longitude = position.coords.longitude;\r\n      console.log(latitude, longitude)\r\n      // 判断是否满足签到条件，例如判断经纬度范围等\r\n      let dis = this.calculateDistance(latitude, longitude, target_latitude, target_longitude);\r\n      console.log(dis);\r\n      if (dis != 0) {\r\n        this.canSignIn = true;\r\n      } else {\r\n        this.canSignIn = false;\r\n      }\r\n\r\n      if (this.canSignIn) {\r\n        //发送签到请求\r\n        console.log(pre_item);\r\n        singInByPid(pre_item.pid).then(res => {\r\n            if (res.data.results.isSignUp) {\r\n                alert('签到成功')\r\n                getUserInfoById(this.$route.params.id).then(res => {\r\n                    console.log(this.$route.params.id)\r\n                    console.log(res)\r\n                    this.uid = res.data.results.id\r\n                    this.name = res.data.results.name\r\n                    this.email = res.data.results.email\r\n                    this.appointments = res.data.results.pre_list\r\n                    //console.log(this.appointments)\r\n                    //this.startCountdown();\r\n                })                \r\n            } else {\r\n                alert('签到失败')\r\n            }\r\n        })\r\n      } else {\r\n        alert('不在签到范围内！');\r\n      }\r\n    },\r\n    errorCallback(error) {\r\n      // 处理获取位置失败的情况\r\n      switch (error.code) {\r\n        case error.PERMISSION_DENIED:\r\n          alert('用户拒绝地理位置定位请求');\r\n          break;\r\n        case error.POSITION_UNAVAILABLE:\r\n          alert('无法获取当前位置信息');\r\n          break;\r\n        case error.TIMEOUT:\r\n          alert('获取位置信息超时');\r\n          break;\r\n        case error.UNKNOWN_ERROR:\r\n          alert('发生未知错误');\r\n          break;\r\n      }\r\n    },\r\n    startCountdown() {\r\n      this.appointments.forEach((appointment) => {\r\n        const updateTime = () => {\r\n          const startTime = new Date(appointment.start_time).getTime();\r\n          const currentTime = new Date().getTime();\r\n          const remainingTime = startTime - currentTime;\r\n        //   console.log(appointment.start_time)\r\n          appointment.remainingTime = remainingTime > 0 ? remainingTime : 0;\r\n\r\n          if (remainingTime <= 0) {\r\n            clearInterval(appointment.countdownIntervalId);\r\n            appointment.remainingTime = 0;\r\n          }\r\n        };\r\n\r\n        updateTime(); // Update immediately\r\n\r\n        if (!appointment.countdownIntervalId) {\r\n          appointment.countdownIntervalId = setInterval(updateTime, 1000); // Update countdown every 1 second (1000 milliseconds)\r\n        }\r\n      });\r\n    },\r\n    stopCountdown(appointment) {\r\n      clearInterval(appointment.countdownIntervalId);\r\n      appointment.countdownIntervalId = null;\r\n      appointment.remainingTime = 0;\r\n    },\r\n    getRemainingTime(appointment) {\r\n      if (appointment.remainingTime !== null) {\r\n        const hours = Math.floor(appointment.remainingTime / (1000 * 60 * 60));\r\n        const minutes = Math.floor((appointment.remainingTime % (1000 * 60 * 60)) / (1000 * 60));\r\n        const seconds = Math.floor((appointment.remainingTime % (1000 * 60)) / 1000);\r\n        return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\r\n      }\r\n      return '';\r\n    },\r\n  },\r\n  beforeDestroy() {\r\n    if (this.appointments != null) {\r\n        this.appointments.forEach((appointment) => {\r\n        clearInterval(appointment.countdownIntervalId);\r\n        });\r\n    }\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SignIn.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SignIn.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SignIn.vue?vue&type=template&id=7d4f9c42&\"\nimport script from \"./SignIn.vue?vue&type=script&lang=js&\"\nexport * from \"./SignIn.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import {request} from \"./request\";\n\nexport function getNotices() {\n    return request({\n        method: 'post',\n        url: '/notice/get/list',\n        data: {\n            \"currentPage\": 1,\n            \"pageSize\": 10,\n            \"title\": \"\"\n        }\n    })\n}\n\nexport function getClass() {\n    return request({\n        method: 'put',\n        url: '/admin/class/find/list',\n        data: {\n            \"currentPage\": 1,\n            \"pageSize\": 10,\n            \"title\": \"\"\n        }\n    })\n}\n\nexport function getClassById(id) {\n    return request({\n        method: 'get',\n        url: '/seat/get/list/' + id\n    })\n}\n\nexport function checkedSeat(data) {\n    return request({\n        method: 'post',\n        url: '/class-user/check',\n        data: {\n            \"classId\": data.cid,\n            \"seatNum\": data.sid\n        }\n    })\n}\n\nexport function getClassroom() {\n    //let param = new URLSearchParams();\n    return request({\n        method: 'get',\n        url: '/classrooms/overview',\n    })\n}\n\nexport function updateClassroomInfo(cid, start_time, end_time) {\n    let param = new URLSearchParams();\n    param.append('cid', cid);\n    param.append('start_time', start_time);\n    param.append('end_time', end_time);\n    return request({\n        method: 'post',\n        url: '/classrooms/modify_time',\n        data: param\n    })    \n}\n\nexport function getClassroomById(id) {\n    return request({\n        method: 'get',\n        url: '/classrooms/detail/?cid=' + id\n    })\n}\n\nexport function getCurSeatDataById(id) {\n    return  request({\n        method: 'get',\n        url: '/seats/detail/?sid=' + id\n    })\n}\n\nexport function getUserInfoById(id) {\n    return request({\n        method: 'get',\n        url: '/students/detail/?uid=' + id\n    })\n}\n\nexport function submitOrder(uid, sid, start_time, end_time) {\n    let param = new URLSearchParams();\n    param.append('uid', uid);\n    param.append('sid', sid);\n    param.append('start_time', start_time);\n    param.append('end_time', end_time)\n    return request({\n        method: 'post',\n        url: '/students/preserve',\n        data: param\n    })\n}\n\nexport function singInByPid(pid) {\n    let param = new URLSearchParams();\n    param.append('pid', pid);\n    return request({\n        method: 'post',\n        url: '/preserve/check_in',\n        data: param\n    })\n}\n\nexport function cancelByPid(pid) {\n    let param = new URLSearchParams();\n    param.append('pid', pid);\n    return request({\n        method: 'post',\n        url: '/preserve/cancel',\n        data: param\n    })\n}"],"names":["render","_vm","this","_c","_self","staticClass","attrs","size","slot","_v","_s","email","name","violate","appointments","scopedSlots","_u","key","fn","scope","getRemainingTime","row","is_check_in","on","$event","signIn","cancelSignIn","staticRenderFns","data","uid","password","canSignIn","mounted","getUserInfoById","$route","params","id","then","res","console","log","results","pre_list","startCountdown","methods","calculateDistance","lat1","lon1","lat2","lon2","earthRadius","degToRad","deg","Math","PI","deltaLat","deltaLon","a","sin","cos","c","atan2","sqrt","distance","pre_item","cancelByPid","pid","isCancel","alert","singInByPid","isSignUp","successCallback","position","target_latitude","target_longitude","latitude","coords","longitude","dis","errorCallback","error","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","forEach","appointment","updateTime","startTime","Date","start_time","getTime","currentTime","remainingTime","clearInterval","countdownIntervalId","setInterval","stopCountdown","hours","floor","minutes","seconds","toString","padStart","beforeDestroy","component","getClassroom","request","method","url","updateClassroomInfo","cid","end_time","param","URLSearchParams","append","getClassroomById","getCurSeatDataById","submitOrder","sid"],"sourceRoot":""}